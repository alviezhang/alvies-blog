{"componentChunkName":"component---src-templates-blog-post-js","path":"/archives/2015-06-28-openwrt-mount-usb-exroot/","result":{"data":{"site":{"siteMetadata":{"title":"Alvie's Blog"}},"markdownRemark":{"id":"67779b1f-e76f-561b-a260-69ffca77027f","excerpt":"设备信息   步骤 安装所需要的软件包 挂载USB分区（假设对应分区为） 编辑 拷贝root文件到USB文件系统中 ，搞定 更多信息请参考官方文档Rootfs on External Storage (extroot)","html":"<h4>设备信息</h4>\n<p><code class=\"language-text\">TP-Link WR-720N Version: 4.0</code></p>\n<p><code class=\"language-text\">OpenWrt Barrier Breaker 14.07 / LuCI Trunk (0.12+svn-r10530)</code></p>\n<h4>步骤</h4>\n<ul>\n<li>安装所需要的软件包</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">opkg update\nopkg <span class=\"token function\">install</span> block-mount kmod-usb-storage kmod-fs-ext4\n<span class=\"token function\">reboot</span></code></pre></div>\n<ul>\n<li>挂载USB分区（假设对应分区为<code class=\"language-text\">/dev/sda1</code>）</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> /mnt/usb\n<span class=\"token function\">mount</span> -t ext4 /dev/sda1 /mnt/usb</code></pre></div>\n<ul>\n<li>编辑<code class=\"language-text\">fstab</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\">config &#39;global&#39;\noption  anon_swap   &#39;0&#39;\noption  anon_mount  &#39;0&#39;\noption  auto_swap   &#39;1&#39;\noption  auto_mount  &#39;1&#39;\noption  delay_root  &#39;5&#39;\noption  check_fs    &#39;0&#39;\n\nconfig &#39;mount&#39;\noption  target  &#39;/&#39;\noption  device  /dev/sda1\noption  enabled &#39;1&#39;\noption  fstype  ext4\noption  options rw,sync\noption  enabled_fsck    0</code></pre></div>\n<ul>\n<li>拷贝root文件到USB文件系统中</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> /tmp/cproot\n<span class=\"token function\">mount</span> --bind / /tmp/cproot\n<span class=\"token function\">tar</span> -C /tmp/cproot -cvf - <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">|</span> <span class=\"token function\">tar</span> -C /mnt/usb -xvf -\n<span class=\"token function\">sync</span> <span class=\"token punctuation\">;</span> <span class=\"token function\">umount</span> /mnt/usb\n<span class=\"token function\">umount</span> /tmp/cproot</code></pre></div>\n<ul>\n<li><code class=\"language-text\">reboot</code>，搞定</li>\n</ul>\n<hr>\n<p>更多信息请参考官方文档<a href=\"http://wiki.openwrt.org/doc/howto/extroot\">Rootfs on External Storage (extroot)</a></p>","frontmatter":{"title":"OpenWrt 挂载 USB 存储设置 exroot","date":"June 28, 2015","description":null}},"previous":{"fields":{"slug":"/archives/2015-06-09-singleton-in-python/"},"frontmatter":{"title":"Python 中的单例模式"}},"next":{"fields":{"slug":"/archives/2015-07-27-vim-add-line-number/"},"frontmatter":{"title":"用VIM给文件添加行号"}}},"pageContext":{"id":"67779b1f-e76f-561b-a260-69ffca77027f","previousPostId":"8574e977-02c8-518b-920b-ce4d44982888","nextPostId":"c98ca8c6-b55b-5951-add4-b74469ea71cb"}},"staticQueryHashes":["2841359383","3257411868"]}